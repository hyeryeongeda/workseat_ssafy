---
# 📘 5장-2. AI 모델 활용 ― Ambient AI
---

## 🧩 들어가며

> “AI가 단순히 데이터를 학습하는 것을 넘어, **환경 전체와 상호작용하며 스스로 적응하는 시대**가 오고 있습니다.”

이 장에서는 **실제 AI 모델이 어떻게 ‘현실 환경(Ambient)’ 속에서 작동하는지**,
그리고 **하드웨어·센서·도메인 전문지식**을 활용해 **리소스 효율성과 실시간성**을 높이는 방법을 배웁니다.

핵심 주제는 다음 네 가지예요.
1️⃣ 100% 정수연산 양자화 (가속기 구동)
2️⃣ 테스트 타임 도메인 적응 (TTA)
3️⃣ 적응적 센싱 (Adaptive Sensing)
4️⃣ 도메인 전문지식 기반 모델 설계

---

## 1️⃣ 가속기 구동을 위한 100% 정수연산 양자화

> “AI 모델이 빠르게 작동하려면, 수학적인 계산 방식부터 효율적이어야 합니다.”

### 💡 왜 정수연산이 필요할까?

- 우리가 흔히 사용하는 **GPU·TPU·NPU** 같은 가속기는
  실수(Float)보다 **정수(Int)** 계산에 특화되어 있습니다.
- 그런데 기존 딥러닝 모델은 대부분 실수 연산으로 구성되어 있죠.
- 그래서 가속기 위에서 효율적으로 동작하려면,
  모델 내부 연산을 **완전히 정수 기반으로 변환(Quantization)** 해야 합니다.

### ⚙️ 일반 양자화 vs 100% 정수연산 양자화

| 구분            | 일반 양자화    | 100% 정수연산 양자화 |
| --------------- | -------------- | -------------------- |
| 스케일 파라미터 | 실수형         | 정수형으로 근사      |
| 연산            | 실수·정수 혼합 | 완전한 정수 연산     |
| 가속기 호환성   | 부분적         | ✅ 완전 호환         |

> 즉, 실수 연산이 단 한 줄이라도 남아 있으면,
> NPU는 다시 CPU로 연산을 넘기게 되어 속도와 전력 효율이 떨어집니다.

### 🧮 핵심 기술 3가지

1️⃣ **비트 쉬프팅(bit shifting)**
 → 곱셈·나눗셈을 비트 이동으로 근사 (하드웨어 친화적)

2️⃣ **BN 폴딩(BatchNorm Folding)**
 → BatchNorm 계층을 이전 합성곱 계층에 병합시켜 실수 연산 제거

3️⃣ **비전 트랜스포머 연산 양자화**
 → Softmax, GELU, LayerNorm 같은 복잡한 연산을 정수 근사함수로 변환

💬 결과적으로,
**가속기에서 100% 정수 연산이 가능해지면**
👉 전력은 절감되고,
👉 엣지 디바이스(모바일·IoT)에서도 실시간 추론이 가능해집니다.

---

## 2️⃣ 테스트 타임 도메인 적응 (Test-Time Adaptation, TTA)

> “학습 데이터와 실제 환경 데이터는 항상 다릅니다.
> 그 차이를 **AI가 스스로 보정**할 수 있을까요?”

### 🧠 핵심 개념

- **도메인 이동(Distribution Shift)**:
  학습 데이터의 분포와 실제 입력 데이터의 분포가 다를 때 발생하는 현상입니다.
- **TTA**는 이런 차이를 테스트 중에 **자동으로 적응**하도록 모델을 미세 조정하는 기법이에요.
- 라벨이 없는 테스트 환경에서도 **엔트로피 최소화(entropy minimization)** 로 안정화합니다.

---

### 🔹 CNN 기반 TTA의 대표 방법

| 방법     | 아이디어                                            | 특징              |
| -------- | --------------------------------------------------- | ----------------- |
| **TENT** | 테스트 데이터로 BatchNorm의 통계(평균, 분산) 갱신   | 간단하지만 불안정 |
| **SAR**  | 예측이 확실한 샘플만 사용 (엔트로피 낮은 샘플 선택) | 안정성 향상       |

💬 “모든 데이터를 맹목적으로 학습하지 말고,
확신(confidence)이 높은 데이터만 살짝 반영하자”는 접근이에요.

---

### 🔹 비전-언어모델 기반 TTA

| 방법                              | 내용                                                            |
| --------------------------------- | --------------------------------------------------------------- |
| **TPT (Test-time Prompt Tuning)** | 테스트 이미지를 여러 버전으로 증강 → 평균 엔트로피 최소화       |
| **PromptAlign**                   | 학습·테스트 시점의 통계(평균·분산)를 정렬시키며 프롬프트 최적화 |

> 이 방식은 프롬프트(지시어)만 살짝 조정하기 때문에,
> 전체 모델을 재학습할 필요가 없고 **빠르고 효율적인 적응**이 가능합니다.

---

## 3️⃣ 적응적 센싱 (Adaptive Sensing)

> “모델을 더 키우지 말고,
> **센서가 더 똑똑하게 ‘데이터를 고르게’ 하자.**”

### 💡 배경

- 대형 모델을 학습시켜도 실제 환경에서는 성능이 떨어질 때가 많아요.
- 조명, 각도, 노이즈 등 **입력의 품질이 불안정**하기 때문이죠.
- 따라서 AI가 “스스로 센서 입력을 선택”하면 훨씬 효율적일 수 있습니다.

---

### 🔹 동작 과정

1️⃣ 센서가 여러 설정값(예: ISO, 셔터속도 등)을 후보로 잡음
2️⃣ 각 설정으로 이미지를 촬영
3️⃣ 모델의 Confidence Score(신뢰도)가 가장 높은 이미지를 선택
4️⃣ 선택된 이미지만 최종 추론에 사용

---

### 🔹 실험 결과

| 비교 대상              | 성능 향상률                                | 비고                   |
| ---------------------- | ------------------------------------------ | ---------------------- |
| Lens vs Auto-Exposure  | +47.56% (ResNet50 기준)                    | 단순한 센서 조정만으로 |
| 작은 모델 vs 대형 모델 | 작은 모델(EfficientNet-B3)이 CLIP보다 정확 | 환경 제어의 힘         |

💬 **핵심 교훈:**
환경에 맞는 입력 제어만 잘해도,
모델을 키우는 것보다 더 큰 성능 향상을 얻을 수 있습니다.

---

## 4️⃣ 도메인 전문지식을 활용한 AI 모델 설계

> “전문가의 지식과 경험을 AI에 녹이면,
> 데이터가 적더라도 훨씬 똑똑한 모델을 만들 수 있어요.”

---

### 🩺 사례 1. 수면다원검사 자동채점 AI

- **문제:** 전문가가 2시간 동안 수동 채점해야 함
- **해결:** 시계열 신호를 **이미지 형태로 변환**하여 Vision Transformer로 분석
- **결과:** AASM 가이드라인과 일치, 사람과 유사한 정확도 확보

💬 포인트:
의료 전문지식(수면 단계, 생체리듬)을 활용해
데이터 전처리와 모델 구조를 설계한 사례입니다.

---

### 😴 사례 2. 비접촉식 수면 무호흡 진단 AI

- **문제:** 카메라 영상 기반 비접촉 진단 (개인정보 민감)
- **방법:** 온디바이스 실시간 추론 (경량 MoViNet 모델)
- **핵심:** “호흡 각성(Respiratory Arousal)” 패턴을 감지하여 무호흡 간접 추론
- **성과:** CPU에서도 30초 내 추론, 의료기기 수준의 정확도

💬 의료 도메인의 핵심 개념을 바탕으로
복잡한 문제를 단순화한 “지식 주입형 설계”입니다.

---

## 🧭 정리하며

| 주제                   | 핵심 키워드                     | 핵심 메시지             |
| ---------------------- | ------------------------------- | ----------------------- |
| **양자화**             | 정수 연산, BN 폴딩, 비트 쉬프팅 | 하드웨어 효율성 향상    |
| **TTA**                | 엔트로피 최소화, Prompt Tuning  | 테스트 시점 자동 적응   |
| **적응적 센싱**        | 센서 제어, Confidence 기반 선택 | 데이터 품질로 성능 향상 |
| **도메인 지식 모델링** | 의료·산업 특화 설계             | 데이터 효율성 극대화    |

---

### 📌 요약 문장

> “모델을 더 키우는 대신,
> **환경·센서·도메인을 똑똑하게 설계하는 것이 진짜 AI 활용의 핵심이다.**”
